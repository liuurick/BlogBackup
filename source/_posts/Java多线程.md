---
title: Java多线程
date: 2020-08-04 09:52:37
tags: [Java,多线程,JavaSE]
categories: 多线程
---
### 

<!--more-->

### 一.基本概念：程序、进程、线程

程序(program)是为完成特定任务、用某种语言编写的一组指令的集合。即指一段静态的代码，静态对象。
进程(process)是程序的一次执行过程，或是正在运行的一个程序。是一个动态的过程：有它自身的产生、存在和消亡的过程。也就是生命周期



>如：运行的QQ，运行中的MP3播放器
>程序是静态的，进程是动态的
>进程作为资源分配的单位，系统在运行时会为每个进程不同的内存区域。

线程(thread)：进程可以进一步细化为线程，是一个程序内部的一条执行路径。
>若一个进程同一时间并行执行多个线程，就是支持多线程的。
>线程作为调度和执行的单位，每个线程拥有独立的运行栈和程序计数器(PC)，线程切换的开销小
>一个进程中的多个线程共享相同的内存单元/内存地址空间->它们从同一堆中分配对象，可以访问相同的变量和对象。这就使得线程间通信更简便、高效。但多个线程操作共享的系统资源可能带来安全的隐患。
>



**单核CPU与多核CPU的理解**

单核CPU，其实是一种假的多线程，因为在一个时间单元内，也只能执行一个线程的任务。例如：虽然有多车道，但是收费站只有一个工作人员在收费，只有收了费才能通过，那么CPU就好比收费人员。如果有某个人不想交钱，那么收费人员可以把他“挂起”。但是因为CPU时间单元特别短，所以感觉不出来。

多核CPU



**并发与并行**

并行：多个CPU同时执行多个任务。例如：多个人同时做不同的事情。

并发：一个CPU（采用时间片）同时执行多个任务。例如：秒杀，多个人做一件事。



**多线程的优点**

1.提高应用程序的响应。对图形化界面更有意义，可以增强用户体验。

2.提高计算机系统CPU的利用率

3.改善程序结构。将既长又复杂的进程分为多个线程，独立运行，利于理解和修改



### 二.线程的创建和使用

多线程的创建，方式一：继承与Thread类

1.创建一个类继承于Thread类的子类

2.重写Thread类的run()  ------》将此线程执行的操作声明在run()中

3.创建Thread类的子类的对象

4.通过此对象调用start()







**线程的调度**：





### 三.线程的生命周期



# 线程的状态变化

要想实现多线程，必须在主线程中创建新的线程对象。任何线程一般具有5种状态，即创建，就绪，运行，阻塞，终止。下面分别介绍一下这几种状态：

- 创建状态 

在程序中用构造方法创建了一个线程对象后，新的线程对象便处于新建状态，此时它已经有了相应的内存空间和其他资源，但还处于不可运行状态。新建一个线程对象可采用Thread 类的构造方法来实现，例如 “Thread thread=new Thread()”。

- 就绪状态 

新建线程对象后，调用该线程的 start() 方法就可以启动线程。当线程启动时，线程进入就绪状态。此时，线程将进入线程队列排队，等待 CPU 服务，这表明它已经具备了运行条件。

- 运行状态 

当就绪状态被调用并获得处理器资源时，线程就进入了运行状态。此时，自动调用该线程对象的 run() 方法。run() 方法定义该线程的操作和功能。

- 阻塞状态 

一个正在执行的线程在某些特殊情况下，如被人为挂起或需要执行耗时的输入/输出操作，会让 CPU 暂时中止自己的执行，进入阻塞状态。在可执行状态下，如果调用sleep(),suspend(),wait() 等方法，线程都将进入阻塞状态，发生阻塞时线程不能进入排队队列，只有当引起阻塞的原因被消除后，线程才可以转入就绪状态。

- 死亡状态 

线程调用 stop() 方法时或 run() 方法执行结束后，即处于死亡状态。处于死亡状态的线程不具有继续运行的能力。

在此提出一个问题，Java 程序每次运行至少启动几个线程？

回答：至少启动两个线程，每当使用 Java 命令执行一个类时，实际上都会启动一个 JVM，每一个JVM实际上就是在操作系统中启动一个线程，Java 本身具备了垃圾的收集机制。所以在 Java 运行时至少会启动两个线程，一个是 main 线程，另外一个是垃圾收集线程。


### 四.线程的同步


### 五.线程的通信

### 六.JDK5.0新增线程创建方式